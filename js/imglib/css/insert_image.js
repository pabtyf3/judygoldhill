/********************************************************************
 * imgLib v0.1.2 09.04.2011
 * Contact me at dev@jstoys.org.ua
 * Site: http://jstoys.org.ua/
 * This copyright notice MUST stay intact for use.
 ********************************************************************/

addEvent(window,"load",function(){loadImage()});var imgLibManager={init:function(a){a=a||{};this.width=a.width||600;this.height=a.height||500;this.returnTo=a.returnTo||""},open:function(){window.open("index.html"+(this.returnTo!==""?"?returnto="+this.returnTo:""),"imglib","width="+this.width+", height="+this.height+", location=0, status=no, toolbar=no, menubar=no, scrollbars=yes, resizable=yes")}};imgLibManager.init({returnTo:"selectImage"}); function showPreview(){$("preview").src=$("src").value;$("preview").style.visibility="visible"} function selectImage(a,b){$("src").value=a;if(b){var d=b.img_size.split("x"),e=$("file_info"),c=getDateF(b.date*1E3,1),f=getHumanSize(b.filesize),g=new Image;$("width").value=d[0];$("height").value=d[1];$("preview").setAttribute("src",b.wwwThumbPath);$("file_size").innerHTML=f;$("file_date").innerHTML=c;g.onload=function(){var a=$("preview"),c=g.width,d=g.height,h=c/200>d/150?c/200:d/150,f=Math.round(c/h),h=Math.round(d/h);if(c!==f||d!==h)a.style.width=f+"px",a.style.height=h+"px";e.style.display= "block";setTransparency(e.getElementsByTagName("div")[1],80);a.setAttribute("src",b.wwwThumbPath);$("preview").style.visibility="visible";a.parentNode.innerHTML=a.parentNode.innerHTML};g.src=b.wwwThumbPath}else showPreview()} function insertImage(){var a=WYSIWYG_Popup.getParam("wysiwyg"),b=document.getElementById("src").value,d=document.getElementById("alt").value,e=document.getElementById("width").value,c=document.getElementById("height").value,f=document.getElementById("border").value,g=document.getElementById("align").value,i=document.getElementById("vspace").value,j=document.getElementById("hspace").value;WYSIWYG.insertImage(b,e,c,g,f,d,j,i,a);window.close()} function loadImage(){var a=WYSIWYG_Popup.getParam("wysiwyg");if(a&&WYSIWYG){var b=WYSIWYG.getSelection(a),b=WYSIWYG.getRange(b),b=WYSIWYG.findParent("img",b);if(b!=null){for(var d=0;d<b.attributes.length;d++){var e=b.attributes[d].name.toLowerCase(),c=b.attributes[d].value;if(e&&c&&c!="null")switch(e){case "src":WYSIWYG_Core.isMSIE&&(c=WYSIWYG.stripURLPath(a,c,!1));document.getElementById("src").value=c;selectImage(c);break;case "alt":document.getElementById("alt").value=c;break;case "align":selectItemByValue(document.getElementById("align"), c);break;case "border":document.getElementById("border").value=c;break;case "hspace":document.getElementById("hspace").value=c;break;case "vspace":document.getElementById("vspace").value=c;break;case "width":document.getElementById("width").value=c;break;case "height":document.getElementById("height").value=c}}if(!WYSIWYG_Core.isMSIE&&document.getElementById("width").value==""&&document.getElementById("width").value=="")document.getElementById("width").value=b.style.width.replace(/px/,""),document.getElementById("height").value= b.style.height.replace(/px/,"")}}}function selectItemByValue(a,b){if(a.options.length)for(var d=0;d<a.options.length;d++)if(a.options[d].value==b)a.options[d].selected=!0};